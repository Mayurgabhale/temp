if (tab === 0) {
  const params = {
    ...baseParams,
    from: formatLocalDate(from),
    to: formatLocalDate(to, true),
    employees: selectedEmps.join(',')
  };
  
  const resp = await axios.get('/api/reports/daily-access', { params });

  // Create proper date objects for comparison (timezone-safe)
  const startDate = new Date(from);
  startDate.setHours(0, 0, 0, 0);
  
  const endDate = new Date(to);
  endDate.setHours(23, 59, 59, 999);

  // Filter the data to ensure it's within the requested range
  const filtered = resp.data.data.filter(r => {
    const recordDate = new Date(r.LocaleMessageTime);
    return recordDate >= startDate && recordDate <= endDate;
  });

  await generateDailyAccessExcel(filtered);
}