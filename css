

import React, { useMemo, useState } from 'react';
import { Card, Row, Col, Button } from 'react-bootstrap';
import {
  FaUsers,
  FaEnvelopeOpenText,
  FaMobileAlt,
  FaMapMarkerAlt
} from 'react-icons/fa';
// import '../styles/ErtOverview.css'; // Optional external styling

const roleIcon = <FaUsers className="text-success" />;

export default function ErtOverview({ ertData }) {
  const [showAll, setShowAll] = useState(false);

  // Show 18 initially (6 per column Ã— 3 columns)
  const members = useMemo(() => {
    const raw = ertData?.['Team Members'] ?? [];
    return showAll ? raw : raw.slice(0, 18);
  }, [ertData, showAll]);

  // Split data into 3 columns with 6 people each (max 18 in preview)
  const splitIntoColumns = (data, columns = 3) => {
    const perColumn = Math.ceil(data.length / columns);
    return Array.from({ length: columns }, (_, i) =>
      data.slice(i * perColumn, (i + 1) * perColumn)
    );
  };

  const columns = splitIntoColumns(members, 3);

  return (
    <div className="container-fluid py-3 bg-dark text-white rounded">
      <h4 className="mb-4 fw-bold border-bottom pb-2">Costa Rica ERT Team Members</h4>

      <Row className="g-4">
        {columns.map((column, colIndex) => (
          <Col key={colIndex} md={4}>
            <Card className="bg-black text-white shadow border-0 rounded-4 h-100" >
              <Card.Header className="d-flex align-items-center gap-2 bg-dark text-white fw-semibold rounded-top border-bottom border-secondary">
                {roleIcon}
                <span>Emergency Response Team (Costa Rica)</span>
              </Card.Header>
              <Card.Body className="px-3 py-2">
                {column.map((member, i) => (
                  <div
                    key={i}
                    className="mb-3 pb-3 border-bottom border-secondary-subtle"
                  >
                    <div className="fw-medium fs-6">{member.name}</div>
                    <div className="mt-1 small">
                      <div className="d-flex align-items-center mb-1">
                        <FaEnvelopeOpenText className="me-2 text-info" />
                        <a
                          href={`mailto:${member.email}`}
                          className="text-decoration-none text-info"
                        >
                          {member.email}
                        </a>
                      </div>
                      <div className="d-flex align-items-center mb-1">
                        <FaMobileAlt className="me-2 text-muted" />
                        <span className="text-light">Emp ID: {member.emp_id}</span>
                      </div>
                      <div className="d-flex align-items-center">
                        <FaMapMarkerAlt className="me-2 text-danger" />
                        <span className="text-danger">Costa Rica</span>
                      </div>
                    </div>
                  </div>
                ))}
              </Card.Body>
            </Card>
          </Col>
        ))}
      </Row>

      <div className="text-center mt-4">
        <Button
          variant="outline-light"
          size="sm"
          className="px-4 rounded-pill shadow-sm"
          onClick={() => setShowAll((prev) => !prev)}
        >
          {showAll ? 'Show Less' : 'Show More'}
        </Button>
      </div>
    </div>
  );
}
