const handlePartitionChange = (newCode) => {
  if (!newCode) {
    navigate('/');
    return;
  }

  const path = location.pathname;

  let newPath = `/partition/${encodeURIComponent(newCode)}`;

  if (path === '/history') {
    // global history â†’ change to partition history
    newPath = `/partition/${encodeURIComponent(newCode)}/history`;
  } else if (path.includes('/history')) {
    // already on partition history
    newPath = `/partition/${encodeURIComponent(newCode)}/history`;
  } else if (path.includes('/details')) {
    // details page
    newPath = `/partition/${encodeURIComponent(newCode)}/details`;
  }

  navigate(newPath);
};