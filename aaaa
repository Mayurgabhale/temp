SELECT
  ...
FROM Ranked
WHERE rn = 1
  AND Direction = 'InDirection';






const filteredRows = rows
  .reduce((unique, row) => {
    const keyGUID = `${row.PersonGUID}-${row.PersonnelType}`;
    if (!unique._seen.has(keyGUID)) {
      unique._seen.add(keyGUID);
      unique.rows.push(row);
    }
    return unique;
  }, { _seen: new Set(), rows: [] })
  .rows;







